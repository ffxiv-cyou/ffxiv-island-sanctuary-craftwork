(function(){"use strict";let r;const d=new Array(128).fill(void 0);d.push(void 0,null,!0,!1);function L(e){return d[e]}let m=d.length;function q(e){e<132||(d[e]=m,m=e)}function C(e){const t=L(e);return q(e),t}const R=typeof TextDecoder<"u"?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}};typeof TextDecoder<"u"&&R.decode();let h=null;function y(){return(h===null||h.byteLength===0)&&(h=new Uint8Array(r.memory.buffer)),h}function S(e,t){return e=e>>>0,R.decode(y().subarray(e,e+t))}let k=null;function F(){return(k===null||k.byteLength===0)&&(k=new Uint16Array(r.memory.buffer)),k}let c=0;function T(e,t){const n=t(e.length*2)>>>0;return F().set(e,n/2),c=e.length,n}function b(e,t){const n=t(e.length*1)>>>0;return y().set(e,n/1),c=e.length,n}function B(e,t,n){const _=T(e,r.__wbindgen_malloc),o=c,a=b(t,r.__wbindgen_malloc),i=c,s=r.init_repo(_,o,a,i,n);return g.__wrap(s)}function u(e,t){if(!(e instanceof t))throw new Error(`expected instance of ${t.name}`);return e.ptr}function z(e,t){u(e,g),r.set_pattern(e.__wbg_ptr,t)}let v=null;function l(){return(v===null||v.byteLength===0)&&(v=new Int32Array(r.memory.buffer)),v}function W(e,t){return e=e>>>0,F().subarray(e/2,e/2+t)}function H(e,t,n,_){try{const s=r.__wbindgen_add_to_stack_pointer(-16);u(e,g),u(t,p);const f=b(n,r.__wbindgen_malloc),A=c,w=b(_,r.__wbindgen_malloc),x=c;r.simulate(s,e.__wbg_ptr,t.__wbg_ptr,f,A,w,x);var o=l()[s/4+0],a=l()[s/4+1],i=W(o,a).slice();return r.__wbindgen_free(o,a*2),i}finally{r.__wbindgen_add_to_stack_pointer(16)}}function N(e,t,n,_,o,a,i){try{const w=r.__wbindgen_add_to_stack_pointer(-16);u(e,g),u(t,p);const x=T(_,r.__wbindgen_malloc),I=c,U=b(o,r.__wbindgen_malloc),O=c;r.solve_singleday(w,e.__wbg_ptr,t.__wbg_ptr,n,x,I,U,O,a,i);var s=l()[w/4+0],f=l()[w/4+1],A=W(s,f).slice();return r.__wbindgen_free(s,f*2),A}finally{r.__wbindgen_add_to_stack_pointer(16)}}function V(e,t){return e=e>>>0,y().subarray(e/1,e/1+t)}function $(e,t){try{const a=r.__wbindgen_add_to_stack_pointer(-16),i=b(e,r.__wbindgen_malloc),s=c;r.pattern_predict(a,i,s,t);var n=l()[a/4+0],_=l()[a/4+1],o=V(n,_).slice();return r.__wbindgen_free(n,_*1),o}finally{r.__wbindgen_add_to_stack_pointer(16)}}function G(e,t){try{const a=r.__wbindgen_add_to_stack_pointer(-16),i=b(e,r.__wbindgen_malloc),s=c;r.pattern_predict_adv(a,i,s,t);var n=l()[a/4+0],_=l()[a/4+1],o=W(n,_).slice();return r.__wbindgen_free(n,_*2),o}finally{r.__wbindgen_add_to_stack_pointer(16)}}let M=null;function J(){return(M===null||M.byteLength===0)&&(M=new Int8Array(r.memory.buffer)),M}function K(e,t){return e=e>>>0,J().subarray(e/1,e/1+t)}function P(e,t){try{const a=r.__wbindgen_add_to_stack_pointer(-16),i=b(e,r.__wbindgen_malloc),s=c;r.pattern_demand(a,i,s,t);var n=l()[a/4+0],_=l()[a/4+1],o=K(n,_).slice();return r.__wbindgen_free(n,_*1),o}finally{r.__wbindgen_add_to_stack_pointer(16)}}function Q(e,t,n,_,o,a,i){try{const w=r.__wbindgen_add_to_stack_pointer(-16);u(e,g),u(t,p);const x=T(_,r.__wbindgen_malloc),I=c,U=b(i,r.__wbindgen_malloc),O=c;r.solve_week(w,e.__wbg_ptr,t.__wbg_ptr,n,x,I,o,a,U,O);var s=l()[w/4+0],f=l()[w/4+1],A=W(s,f).slice();return r.__wbindgen_free(s,f*2),A}finally{r.__wbindgen_add_to_stack_pointer(16)}}function X(e){m===d.length&&d.push(d.length+1);const t=m;return m=d[t],d[t]=e,t}const E=typeof TextEncoder<"u"?new TextEncoder("utf-8"):{encode:()=>{throw Error("TextEncoder not available")}},Y=typeof E.encodeInto=="function"?function(e,t){return E.encodeInto(e,t)}:function(e,t){const n=E.encode(e);return t.set(n),{read:e.length,written:n.length}};function Z(e,t,n){if(n===void 0){const s=E.encode(e),f=t(s.length)>>>0;return y().subarray(f,f+s.length).set(s),c=s.length,f}let _=e.length,o=t(_)>>>0;const a=y();let i=0;for(;i<_;i++){const s=e.charCodeAt(i);if(s>127)break;a[o+i]=s}if(i!==_){i!==0&&(e=e.slice(i)),o=n(o,_,_=i+e.length*3)>>>0;const s=y().subarray(o+i,o+_),f=Y(e,s);i+=f.written}return c=i,o}class p{static __wrap(t){t=t>>>0;const n=Object.create(p.prototype);return n.__wbg_ptr=t,n}__destroy_into_raw(){const t=this.__wbg_ptr;return this.__wbg_ptr=0,t}free(){const t=this.__destroy_into_raw();r.__wbg_craftworkinfo_free(t)}get tension(){return r.__wbg_get_craftworkinfo_tension(this.__wbg_ptr)}set tension(t){r.__wbg_set_craftworkinfo_tension(this.__wbg_ptr,t)}get max_tension(){return r.__wbg_get_craftworkinfo_max_tension(this.__wbg_ptr)}set max_tension(t){r.__wbg_set_craftworkinfo_max_tension(this.__wbg_ptr,t)}get level(){return r.__wbg_get_craftworkinfo_level(this.__wbg_ptr)}set level(t){r.__wbg_set_craftworkinfo_level(this.__wbg_ptr,t)}get workers(){return r.__wbg_get_craftworkinfo_workers(this.__wbg_ptr)}set workers(t){r.__wbg_set_craftworkinfo_workers(this.__wbg_ptr,t)}constructor(t,n,_,o){const a=r.craftworkinfo_new(t,n,_,o);return p.__wrap(a)}}class g{static __wrap(t){t=t>>>0;const n=Object.create(g.prototype);return n.__wbg_ptr=t,n}__destroy_into_raw(){const t=this.__wbg_ptr;return this.__wbg_ptr=0,t}free(){const t=this.__destroy_into_raw();r.__wbg_gamedatarepo_free(t)}}async function ee(e,t){if(typeof Response=="function"&&e instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(e,t)}catch(_){if(e.headers.get("Content-Type")!="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",_);else throw _}const n=await e.arrayBuffer();return await WebAssembly.instantiate(n,t)}else{const n=await WebAssembly.instantiate(e,t);return n instanceof WebAssembly.Instance?{instance:n,module:e}:n}}function te(){const e={};return e.wbg={},e.wbg.__wbg_new_abda76e883ba8a5f=function(){const t=new Error;return X(t)},e.wbg.__wbg_stack_658279fe44541cf6=function(t,n){const _=L(n).stack,o=Z(_,r.__wbindgen_malloc,r.__wbindgen_realloc),a=c;l()[t/4+1]=a,l()[t/4+0]=o},e.wbg.__wbg_error_f851667af71bcfc6=function(t,n){let _,o;try{_=t,o=n,console.error(S(t,n))}finally{r.__wbindgen_free(_,o)}},e.wbg.__wbindgen_object_drop_ref=function(t){C(t)},e.wbg.__wbindgen_throw=function(t,n){throw new Error(S(t,n))},e}function ne(e,t){return r=e.exports,D.__wbindgen_wasm_module=t,v=null,M=null,k=null,h=null,r}async function D(e){if(r!==void 0)return r;typeof e>"u"&&(e="/assets/mji_craftwork_bg.wasm");const t=te();(typeof e=="string"||typeof Request=="function"&&e instanceof Request||typeof URL=="function"&&e instanceof URL)&&(e=fetch(e));const{instance:n,module:_}=await ee(await e,t);return ne(n,_)}function j(e){return new p(e.tension,e.max_tension,e.level,e.workers)}async function re(){await D(),self.postMessage({type:"inited"});let e;self.onmessage=async t=>{const n=t.data;if(n.type!=="init_repo"&&!e)return self.reportError("repo is not inited. "+n.type);switch(n.type){case"init_repo":e=B(n.recipe,n.pops,n.pop_row),self.postMessage({type:"init_repo"});break;case"set_pattern":z(e,n.pattern),self.postMessage({type:"set_pattern"});break;case"solve_day":{const _=j(n.state),o=N(e,_,n.level,n.ban_list,n.demands,n.time,n.with_cost);self.postMessage(o,[o.buffer]);break}case"solve_week":{const _=j(n.state),o=Q(e,_,n.level,n.ban_list,n.time,n.with_cost,n.pattern);self.postMessage(o,[o.buffer]);break}case"simulate":{const _=j(n.state),o=H(e,_,n.seq,n.demands);self.postMessage(o,[o.buffer]);break}case"pattern_predict":{const _=$(n.array,n.demands);self.postMessage(_,[_.buffer]);break}case"pattern_predict_adv":{const _=G(n.array,n.demands);self.postMessage(_,[_.buffer]);break}case"pattern_demand":{const _=P(n.array,n.day);self.postMessage(_,[_.buffer]);break}default:console.log("unexpected type",n.type),self.reportError("unexpected type "+n.type);break}}}re()})();

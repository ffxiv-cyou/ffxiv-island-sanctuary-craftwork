(function(){"use strict";let r;const u=new Array(128).fill(void 0);u.push(void 0,null,!0,!1);function L(t){return u[t]}let m=u.length;function C(t){t<132||(u[t]=m,m=t)}function B(t){const e=L(t);return C(t),e}const R=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0});R.decode();let h=null;function y(){return(h===null||h.byteLength===0)&&(h=new Uint8Array(r.memory.buffer)),h}function S(t,e){return R.decode(y().subarray(t,t+e))}let k=null;function F(){return(k===null||k.byteLength===0)&&(k=new Uint16Array(r.memory.buffer)),k}let c=0;function I(t,e){const n=e(t.length*2);return F().set(t,n/2),c=t.length,n}function w(t,e){const n=e(t.length*1);return y().set(t,n/1),c=t.length,n}function D(t,e,n){const s=I(t,r.__wbindgen_malloc),o=c,i=w(e,r.__wbindgen_malloc),_=c,a=r.init_repo(s,o,i,_,n);return g.__wrap(a)}function d(t,e){if(!(t instanceof e))throw new Error(`expected instance of ${e.name}`);return t.ptr}function z(t,e){d(t,g),r.set_pattern(t.ptr,e)}let v=null;function f(){return(v===null||v.byteLength===0)&&(v=new Int32Array(r.memory.buffer)),v}function j(t,e){return F().subarray(t/2,t/2+e)}function H(t,e,n,s){try{const a=r.__wbindgen_add_to_stack_pointer(-16);d(t,g),d(e,b);const l=w(n,r.__wbindgen_malloc),A=c,p=w(s,r.__wbindgen_malloc),W=c;r.simulate(a,t.ptr,e.ptr,l,A,p,W);var o=f()[a/4+0],i=f()[a/4+1],_=j(o,i).slice();return r.__wbindgen_free(o,i*2),_}finally{r.__wbindgen_add_to_stack_pointer(16)}}function N(t,e,n,s,o,i,_){try{const p=r.__wbindgen_add_to_stack_pointer(-16);d(t,g),d(e,b);const W=I(s,r.__wbindgen_malloc),U=c,O=w(o,r.__wbindgen_malloc),T=c;r.solve_singleday(p,t.ptr,e.ptr,n,W,U,O,T,i,_);var a=f()[p/4+0],l=f()[p/4+1],A=j(a,l).slice();return r.__wbindgen_free(a,l*2),A}finally{r.__wbindgen_add_to_stack_pointer(16)}}function V(t,e){return y().subarray(t/1,t/1+e)}function $(t,e){try{const i=r.__wbindgen_add_to_stack_pointer(-16),_=w(t,r.__wbindgen_malloc),a=c;r.pattern_predict(i,_,a,e);var n=f()[i/4+0],s=f()[i/4+1],o=V(n,s).slice();return r.__wbindgen_free(n,s*1),o}finally{r.__wbindgen_add_to_stack_pointer(16)}}let M=null;function G(){return(M===null||M.byteLength===0)&&(M=new Int8Array(r.memory.buffer)),M}function J(t,e){return G().subarray(t/1,t/1+e)}function K(t,e){try{const i=r.__wbindgen_add_to_stack_pointer(-16),_=w(t,r.__wbindgen_malloc),a=c;r.pattern_demand(i,_,a,e);var n=f()[i/4+0],s=f()[i/4+1],o=J(n,s).slice();return r.__wbindgen_free(n,s*1),o}finally{r.__wbindgen_add_to_stack_pointer(16)}}function P(t,e,n,s,o,i,_){try{const p=r.__wbindgen_add_to_stack_pointer(-16);d(t,g),d(e,b);const W=I(s,r.__wbindgen_malloc),U=c,O=w(_,r.__wbindgen_malloc),T=c;r.solve_week(p,t.ptr,e.ptr,n,W,U,o,i,O,T);var a=f()[p/4+0],l=f()[p/4+1],A=j(a,l).slice();return r.__wbindgen_free(a,l*2),A}finally{r.__wbindgen_add_to_stack_pointer(16)}}function Q(t){m===u.length&&u.push(u.length+1);const e=m;return m=u[e],u[e]=t,e}const x=new TextEncoder("utf-8"),X=typeof x.encodeInto=="function"?function(t,e){return x.encodeInto(t,e)}:function(t,e){const n=x.encode(t);return e.set(n),{read:t.length,written:n.length}};function Y(t,e,n){if(n===void 0){const a=x.encode(t),l=e(a.length);return y().subarray(l,l+a.length).set(a),c=a.length,l}let s=t.length,o=e(s);const i=y();let _=0;for(;_<s;_++){const a=t.charCodeAt(_);if(a>127)break;i[o+_]=a}if(_!==s){_!==0&&(t=t.slice(_)),o=n(o,s,s=_+t.length*3);const a=y().subarray(o+_,o+s),l=X(t,a);_+=l.written}return c=_,o}class b{static __wrap(e){const n=Object.create(b.prototype);return n.ptr=e,n}__destroy_into_raw(){const e=this.ptr;return this.ptr=0,e}free(){const e=this.__destroy_into_raw();r.__wbg_craftworkinfo_free(e)}get tension(){return r.__wbg_get_craftworkinfo_tension(this.ptr)}set tension(e){r.__wbg_set_craftworkinfo_tension(this.ptr,e)}get max_tension(){return r.__wbg_get_craftworkinfo_max_tension(this.ptr)}set max_tension(e){r.__wbg_set_craftworkinfo_max_tension(this.ptr,e)}get level(){return r.__wbg_get_craftworkinfo_level(this.ptr)}set level(e){r.__wbg_set_craftworkinfo_level(this.ptr,e)}get workers(){return r.__wbg_get_craftworkinfo_workers(this.ptr)}set workers(e){r.__wbg_set_craftworkinfo_workers(this.ptr,e)}constructor(e,n,s,o){const i=r.craftworkinfo_new(e,n,s,o);return b.__wrap(i)}}class g{static __wrap(e){const n=Object.create(g.prototype);return n.ptr=e,n}__destroy_into_raw(){const e=this.ptr;return this.ptr=0,e}free(){const e=this.__destroy_into_raw();r.__wbg_gamedatarepo_free(e)}}async function Z(t,e){if(typeof Response=="function"&&t instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(t,e)}catch(s){if(t.headers.get("Content-Type")!="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",s);else throw s}const n=await t.arrayBuffer();return await WebAssembly.instantiate(n,e)}else{const n=await WebAssembly.instantiate(t,e);return n instanceof WebAssembly.Instance?{instance:n,module:t}:n}}function tt(){const t={};return t.wbg={},t.wbg.__wbg_new_abda76e883ba8a5f=function(){const e=new Error;return Q(e)},t.wbg.__wbg_stack_658279fe44541cf6=function(e,n){const s=L(n).stack,o=Y(s,r.__wbindgen_malloc,r.__wbindgen_realloc),i=c;f()[e/4+1]=i,f()[e/4+0]=o},t.wbg.__wbg_error_f851667af71bcfc6=function(e,n){try{console.error(S(e,n))}finally{r.__wbindgen_free(e,n)}},t.wbg.__wbindgen_object_drop_ref=function(e){B(e)},t.wbg.__wbindgen_throw=function(e,n){throw new Error(S(e,n))},t}function et(t,e){return r=t.exports,q.__wbindgen_wasm_module=e,v=null,M=null,k=null,h=null,r}async function q(t){typeof t>"u"&&(t="/assets/mji_craftwork_bg.wasm");const e=tt();(typeof t=="string"||typeof Request=="function"&&t instanceof Request||typeof URL=="function"&&t instanceof URL)&&(t=fetch(t));const{instance:n,module:s}=await Z(await t,e);return et(n,s)}function E(t){return new b(t.tension,t.max_tension,t.level,t.workers)}async function nt(){await q(),self.postMessage({type:"inited"});let t;self.onmessage=async e=>{const n=e.data;if(n.type!=="init_repo"&&!t)return self.reportError("repo is not inited. "+n.type);switch(n.type){case"init_repo":t=D(n.recipe,n.pops,n.pop_row),self.postMessage({type:"init_repo"});break;case"set_pattern":z(t,n.pattern),self.postMessage({type:"set_pattern"});break;case"solve_day":{const s=E(n.state),o=N(t,s,n.level,n.ban_list,n.demands,n.time,n.with_cost);self.postMessage(o,[o.buffer]);break}case"solve_week":{const s=E(n.state),o=P(t,s,n.level,n.ban_list,n.time,n.with_cost,n.pattern);self.postMessage(o,[o.buffer]);break}case"simulate":{const s=E(n.state),o=H(t,s,n.seq,n.demands);self.postMessage(o,[o.buffer]);break}case"pattern_predict":{const s=$(n.array,n.demands);self.postMessage(s,[s.buffer]);break}case"pattern_demand":{const s=K(n.array,n.day);self.postMessage(s,[s.buffer]);break}default:console.log("unexpected type",n.type),self.reportError("unexpected type "+n.type);break}}}nt()})();
